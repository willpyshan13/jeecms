<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>往期回顾</title>
    <link rel="stylesheet" href="${res}/css/videoList-newest.css">
    <link rel="stylesheet" href="${res}/css/jSlider.css">
    <link rel="stylesheet" href="${res}/css/zxftList.css">
    <meta name="title" content="${site.seoTitle!}" />
    <meta name="keywords" content="${site.seoKeyword!}" />
    <meta name="description" content="${site.seoDescription!}" />
    <link rel="stylesheet" href="${res}/lib/layui/css/layui.css" />
    <link rel="stylesheet" href="${res}/lib/layui/css/modules/layui-icon-extend/iconfont.css" />
</head>
<body>
     <!-- 顶部导航 -->
     <div class="header-children">
        [#include "./includes/header.html"/]
    </div>
    <div class="zxft-middle">
        <!-- 往期回顾 -->
       
        <div class="zxftBox">
            [#if type=='3']
            <h2>往期回顾</h2>
            [#else]
            <h2>访谈预告</h2>
            [/#if]
            <ul class="previousReviewUl">
                <li>
                    <img src="${res}/images/jeecms 首页 标注.png" alt="">
                    <div class="previousReviewContent">
                        <p class="previousReviewUlP">
                            <span class="previousReviewOne">主题：</span>
                            <span class="previousReviewTwo">市民对话一把手：市发展改革委谈“聚焦优化营商北京市质量技术监督局组织机构代码管理</span>
                        </p>
                        <p class="previousReviewUlP">
                            <span class="previousReviewOne">时间：</span>
                            <span class="previousReviewTwo">2020-05-12 10:30</span>
                        </p>
                        <p class="previousReviewUlP">
                            <span class="previousReviewOne">嘉宾：</span>
                            <span class="previousReviewTwo">李　辉　 北京市质量技术监督局组织机构代码管理北京市质量技术监督局组织机构代码管理</span>
                        </p>
                        <p class="previousReviewUlP">
                            <span class="previousReviewOne">单位：</span>
                            <span class="previousReviewTwo">北京市工商行政管理局登记注册处</span>
                        </p>
                        <p class="previousReviewUlP" style="padding-bottom: 0;">
                            <span class="previousReviewOne">简介：</span>
                            <span class="previousReviewTwo">上海作为一座容纳了2400万常住人口的超大型城市</span>
                        </p>
                    </div>
                </li>
            </ul>
        </div>

        <div class="pages">
            <div id="demo2"></div>
        </div>
    </div>
    
    
    [#include "./includes/footer.html"/]
</body>
<script src="${res}/js/jquery.jSlider.js"></script>
<script src="${res}/js/unslider.min.js"></script>
<script src="${res}/js/video.js"></script>
<script src="${res}/lib/layui/layui.js"></script>
</html>
<script>
    var type = window.location.href.split('=')
    var status = type[1]
    status = status.split('&')
    status = status[0]
    var productAppId = ''
    console.log(status);
    var data = {
        status,
        siteId:'1',
        page:1,
        productAppId,
    }
    var total=0
    if(status == 3){
        data.size=10
    }else if(status == 1){
        data.size=10
    }
    api.GET('/cmsmanager/authorizations/product',{},function(result){
        if(result.code===200){
            data.productAppId = result.data.productAppId
            
            // 获取正在访谈的信息
            sendData()
        }
    })
    function sendData(){
        api.GET('http://api.jeecms.com/MODULE-INTERVIEW/client/v1/online/list',data,function(result){
            if(result.code===200){
                //未开始
                console.log(result);
                if(status==1){
                    statusOne(result.data.content)
                }else if(status==3){//已结束
                    statusThree(result.data.content)
                }
                total=parseInt(result.data.total)
                
            }
        })
    }
    setTimeout(function(){
        layui2()
    },400)
    // sendData()
     //往期介绍
     function statusThree(data){
        if(data.length){
            $('.previousReviewUl').html('')
            for(var i = 0 ; i < data.length ; i++){
                $('.previousReviewUl').append('<li><div class="box-img"><img src="'+data[i].coverImage+'" alt="" onclick=LinkTo(\''+data[i].id+'\')></div><div class="previousReviewContent"><p class="previousReviewUlP"><span class="previousReviewOne">主题：</span><span class="previousReviewTwo zuti"  onclick="LinkTo(\''+data[i].id+'\')">'+data[i].title+'</span></p><p class="previousReviewUlP"><span class="previousReviewOne">时间：</span><span class="previousReviewTwo">'+data[i].interviewTime+'</span></p><p class="previousReviewUlP"><span class="previousReviewOne">嘉宾：</span><span class="previousReviewTwo perviousguests"></span></p><p class="previousReviewUlP"><span class="previousReviewOne">单位：</span><span class="previousReviewTwo">'+data[i].organizer+'</span></p><p class="previousReviewUlP" style="padding-bottom: 0;"><span class="previousReviewOne">简介：</span><span class="previousReviewTwo">'+data[i].summary+'</span></p></div></li>')
                if(data[i].guests){
                    for(var j = 0 ; j <data[i].guests.length ; j++){
                        $('.perviousguests').eq(i).append(''+data[i].guests[j].name+'    '+data[i].guests[j].job+' '+'<br />')
                    }
                }
                
            }
        }else{
            $('.previousReview').remove()
        }
    }
     //访谈预告
     function  statusOne(data){
        if(data.length){
            $('.previousReviewUl').html('')
            for(var i = 0 ; i < data.length ; i++){
                $('.previousReviewUl').append('<li><div class="box-img"><img src="'+data[i].coverImage+'" alt="" onclick=LinkTo(\''+data[i].id+'\')></div><div class="previousReviewContent"><p class="previousReviewUlP"><span class="previousReviewOne">主题：</span><span class="previousReviewTwo zuti"  onclick="LinkTo(\''+data[i].id+'\')">'+data[i].title+'</span></p><p class="previousReviewUlP"><span class="previousReviewOne">时间：</span><span class="previousReviewTwo">'+data[i].interviewTime+'</span></p><p class="previousReviewUlP"><span class="previousReviewOne">嘉宾：</span><span class="previousReviewTwo perviousguests"></span></p><p class="previousReviewUlP"><span class="previousReviewOne">单位：</span><span class="previousReviewTwo">'+data[i].organizer+'</span></p><p class="previousReviewUlP" style="padding-bottom: 0;"><span class="previousReviewOne">简介：</span><span class="previousReviewTwo">'+data[i].summary+'</span></p></div></li>')
                if(data[i].guests){
                    for(var j = 0 ; j <data[i].guests.length ; j++){
                        $('.perviousguests').eq(i).append(''+data[i].guests[j].name+'    '+data[i].guests[j].job+' '+'<br />')
                    }
                }
            }
        }else{
            $('.interviewPreview').remove()
        }
    }
    // 分页
    function LinkTo(id){
            window.location.href='zxftDetails.htm?id='+id
        }
    
    function layui2(){
        layui.use(['laypage', 'layer'], function(){
            var laypage = layui.laypage,layer = layui.layer;
            console.log(data.size);
            laypage.render({
                elem: 'demo2'
                ,count: total
                ,limit: data.size
                ,theme: '#eeeeee'
                ,jump: function(obj, first){
                    console.log(obj.curr); //得到当前页，以便向服务端请求对应页的数据。
                    if(status==3){
                        $('.previousReviewUl').html('')
                    }else{
                        $('.interviewPreviewUl').html('')
                    }
                    data.page=obj.curr;
                    sendData();
                }
            });
        })
    }
    
</script>